
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Operation process &mdash; sfbulk 1.0.2.8 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.1.0/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/my-styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0.2.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="sfbulk 1.0.2.8 documentation" href="index.html" />
    <link rel="next" title="Bulk methods" href="bulk.html" />
    <link rel="prev" title="Installation" href="install.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>
  
  <a href="https://github.com/clearcode/sfbulk"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          sfbulk</a>
      </div>

      <div class="collapse navbar-collapse nav-collapse">
        <ul class="nav navbar-nav">
          <li class="divider-vertical"></li>
          
          
            
              
  <li>
    <a href="install.html" title="Previous Chapter: Installation"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; Installation</span>
    </a>
  </li>
  <li>
    <a href="bulk.html" title="Next Chapter: Bulk methods"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Bulk methods &raquo;</span>
    </a>
  </li>
            
          
          
          
        </ul>

        
          
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        
      </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Operation process</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-salesforce-bulk-api-works">How Salesforce Bulk API works?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#salesforce-bulk-api-monitor">Salesforce Bulk API monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sfbulk-implementation">sfbulk implementation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bulk.html">Bulk methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="exception.html">Handle Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

<form action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9">
      
  <div class="section" id="operation-process">
<span id="id1"></span><h1>Operation process<a class="headerlink" href="#operation-process" title="Permalink to this headline">¶</a></h1>
<p>The Salesforce Bulk API lets you query, insert, update, upsert, or delete a large number of records asynchronously.</p>
<p>All operations use HTTP GET or POST methods to send and receive XML or CSV data.</p>
<div class="section" id="how-salesforce-bulk-api-works">
<h2>How Salesforce Bulk API works?<a class="headerlink" href="#how-salesforce-bulk-api-works" title="Permalink to this headline">¶</a></h2>
<p>You process a set of records by creating a <strong>job that contains one or more batches</strong>. The <strong>job specifies which object is being processed and what type of action is being used</strong> (query, insert, upsert, update, or delete). A job is represented by the <strong>JobInfo</strong> resource. This resource is used to create a new job, get status for an existing job, and change status for a job. A <strong>batch is a set of records sent to the server</strong>. You first send a number of batches to the server using an HTTP POST request and then the server processes the batches in the background. A batch is created by submitting a CSV or XML representation of a set of records and any references to binary attachment. Once created, the status of a batch is represented by a <strong>BatchInfo</strong> resource.  Each batch is processed independently by the server, not necessarily in the order it is received. While batches are being processed, you can track progress by checking the status of the job using an HTTP GET call. When job (that means all batches) is completed, the result for each record is available in a result set resource.</p>
</div>
<div class="section" id="salesforce-bulk-api-monitor">
<span id="id2"></span><h2>Salesforce Bulk API monitor<a class="headerlink" href="#salesforce-bulk-api-monitor" title="Permalink to this headline">¶</a></h2>
<p>Salesforce web interface provides <strong>monitor for Bulk API</strong>. By using it you can monitor the status of recent bulk data load jobs created by <strong>Data Loader</strong> and other <strong>Bulk API client applications</strong>, including <strong>sfbulk</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>BULK API MONITOR</strong>: You&#8217;ll find this monitor under the section: <strong>Setup</strong>-&gt; <strong>Jobs</strong> -&gt; <strong>Bulk Data Load Jobs</strong></p>
</div>
</div>
<div class="section" id="sfbulk-implementation">
<h2>sfbulk implementation<a class="headerlink" href="#sfbulk-implementation" title="Permalink to this headline">¶</a></h2>
<p>This implementation is based on the primary <strong>Bulk object that has methods to control job and batches</strong>. In the present implementation one <strong>Bulk</strong> can simultaneously maintain a one <strong>job</strong> with many <strong>batches</strong>.</p>
<ol class="arabic">
<li><p class="first"><strong>Initialize bulk.</strong></p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sfbulk</span> <span class="kn">import</span> <span class="n">Bulk</span>

<span class="n">bulk</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">()</span>
</pre></div>
</div>
<p>Method docs: <a class="reference internal" href="bulk.html#initialization"><em>initialization</em></a></p>
</div></blockquote>
</li>
<li><p class="first"><strong>Authorize bulk.</strong></p>
<p>Before performing any operations bulk must te authorized by login, password and security token.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">bulk</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s">&#39;username&#39;</span><span class="p">,</span> <span class="s">&#39;pasword&#39;</span><span class="p">,</span> <span class="s">&#39;security_token&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Method docs: <a class="reference internal" href="bulk.html#login"><em>login</em></a></p>
</div></blockquote>
</li>
<li><p class="first"><strong>Create job.</strong></p>
<p>Create a new job that specifies the <strong>object</strong> and <strong>action</strong>.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">bulk</span><span class="o">.</span><span class="n">job_create</span><span class="p">(</span><span class="s">u&#39;query&#39;</span><span class="p">,</span> <span class="s">u&#39;Contact&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Method docs: <a class="reference internal" href="bulk.html#job-create"><em>job_create</em></a></p>
</div></blockquote>
</li>
<li><p class="first"><strong>Create batch/batches.</strong></p>
<p>That&#8217;s how data should be formatted is highly dependent on the type of action.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">data</span> <span class="o">=</span> <span class="s">&#39;SELECT Id FROM Contact&#39;</span>
<span class="n">bulk</span><span class="o">.</span><span class="n">batch_create</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first"><strong>Wait untill job is completed.</strong></p>
<p>Check status of job at a reasonable interval.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="k">while</span> <span class="p">(</span><span class="ow">not</span> <span class="n">bulk</span><span class="o">.</span><span class="n">job_is_completed</span><span class="p">()):</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Method docs: <a class="reference internal" href="bulk.html#job-is-completed"><em>job_is_completed</em></a></p>
</div></blockquote>
</li>
<li><p class="first">Check batch status (optional).</p>
<p>When all batches have either completed or failed, retrieve the status for each batch.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">status</span> <span class="o">=</span> <span class="n">bulk</span><span class="o">.</span><span class="n">batch_status</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Check batch result (optional).</p>
<p>Match the result sets with the original data set to determine which records failed and succeeded.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">result</span> <span class="o">=</span> <span class="n">bulk</span><span class="o">.</span><span class="n">batch_result</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Close job.</p>
<blockquote>
<div><p>Close the job. Once closed, no more batches can be sent as part of the job.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">bulk</span><span class="o">.</span><span class="n">job_close</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014, Clearcode, Natalia Frydrych.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>